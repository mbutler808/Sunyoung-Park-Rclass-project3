<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sunyoung Park">
<meta name="dcterms.date" content="2023-04-22">

<title>Analysis script for identifying the best predictors of biomass for 11 plant species</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="exploratory_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="exploratory_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="exploratory_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="exploratory_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="exploratory_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="exploratory_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="exploratory_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="exploratory_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="exploratory_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="exploratory_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis script for identifying the best predictors of biomass for 11 plant species</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sunyoung Park </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>This Quarto file loads the cleaned data and does some initial analysis.</p>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<p>In this analysis script, I am analyzing direct measurements of 11 different morphological characteristics and aboveground biomass to identify the best non-destructive indicators for the aboveground biomass of each of the 11 plant species.</p>
<p>I am using regression analysis to perform my analysis.</p>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">read_chunk</span>(<span class="st">'statistical_analysis.R'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load needed packages and filepaths.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load needed packages. make sure they are installed</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2) <span class="co">#for plotting</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(lattice) <span class="co"># for plotting</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(magrittr) <span class="co">#for piping</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(knitr) <span class="co">#for formatting output</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(corrr) <span class="co">#for correlation analysis</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggcorrplot) <span class="co">#for plotting correlation matrix</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># path to data and results </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>data_path <span class="ot">&lt;-</span> <span class="st">"../../Data/Processed_data/"</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>results_path <span class="ot">&lt;-</span> <span class="st">"../../Results/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load custom functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to paste path to output filenames</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>addpath <span class="ot">&lt;-</span> <span class="cf">function</span>( filename, <span class="at">path=</span>data_path ) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    location <span class="ot">&lt;-</span> <span class="fu">paste</span>( path, filename, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( location )</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>( <span class="fu">addpath</span>(<span class="st">"processeddata.rds"</span>, data_path) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="results-of-the-data-analysis" class="level1">
<h1>Results of the data analysis</h1>
<p>The results were created by the <code>statistical_analysis.R</code> script and to the <code>Results</code> folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This part of the code tests for normality using a Shapiro-Wilk test.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The loop tests for normality in each species in the same order the dataframes are listed in spec.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We split the plant (d1) dataframe into a list of dataframes (aka spec) by species. </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">with</span>(dat, <span class="fu">split</span>(dat, <span class="fu">list</span>(<span class="at">Species =</span> Species)))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">lapply</span>(spec, <span class="cf">function</span>(x) x[, <span class="fu">colSums</span>(<span class="fu">is.na</span>(x)) <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>spec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Aptenia cordifolia`
   Sample number Location   Type Treatment   Size            Species
1              1      SME garden vegetated  small Aptenia cordifolia
2              2      SME garden vegetated  small Aptenia cordifolia
3              3      SME garden vegetated  small Aptenia cordifolia
4              4      SME garden vegetated  large Aptenia cordifolia
5              5      SME garden vegetated  large Aptenia cordifolia
6              6      SME garden vegetated  large Aptenia cordifolia
57            57    OSLER garden vegetated medium Aptenia cordifolia
58            58    OSLER garden vegetated medium Aptenia cordifolia
59            59    OSLER garden vegetated medium Aptenia cordifolia
   Width_farthest Width_perpendicular Branch_length Branch_diameter
1            17.5                14.0          4.50           0.430
2            10.0                 7.5          3.17           0.400
3            12.0                 9.5          3.75           0.350
4            59.5                30.0         13.00           0.370
5            44.5                22.0         11.00           0.460
6            84.0                35.0         34.85           0.320
57           68.0                39.0         20.10           0.336
58           58.5                47.0         23.34           0.376
59           32.0                24.0         11.35           0.446
   Leaves_per_branch Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin
1                8.4       3.5       1.5      2.48       2.3       1.1
2                7.4       3.0       1.0      2.07       2.0       0.8
3               10.5       3.8       1.8      2.79       2.4       1.1
4               28.0       5.3       1.8      3.44       3.2       1.3
5               18.2       3.5       1.5      2.61       2.0       0.8
6               22.0       4.5       1.4      2.73       3.0       1.0
57              17.0       4.0       1.6      2.93       2.0       1.0
58              16.2       3.7       1.7      2.57       2.2       1.0
59              21.2       3.2       1.5      2.41       1.8       0.9
   Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg Biomass Measurement_location
1       1.79      0.27      0.16     0.210    3.34                field
2       1.46      0.26      0.09     0.160    1.46                field
3       1.78      0.28      0.12     0.160    1.36                field
4       2.12      0.20      0.14     0.160   11.79                field
5       1.60      0.27      0.11     0.180   14.45                field
6       1.84      0.17      0.09     0.130   29.83                field
57      1.52      0.16      0.10     0.120    6.69                field
58      1.53      0.17      0.12     0.130   12.18                field
59      1.36      0.24      0.14     0.207    6.75                field

$`Artemisia californica`
   Sample number Location    Type Treatment   Size               Species
65            77      SME natural vegetated  small Artemisia californica
66            78      SME natural vegetated  small Artemisia californica
67            79      SME natural vegetated medium Artemisia californica
68            80      SME natural vegetated medium Artemisia californica
69            81      SME natural vegetated  large Artemisia californica
77            88      SME natural vegetated  large Artemisia californica
   Plant type Height Width_farthest Width_perpendicular Branch_length
65      shrub   31.0             36                28.5         18.05
66      shrub   32.0             47                31.5         17.20
67      shrub   52.5             50                51.0         44.80
68      shrub   60.0             55                46.0         49.95
69      shrub   66.0            100                88.0         53.10
77      shrub   64.0             84                64.0         43.80
   Branch_diameter Branches_per_stem Biomass Measurement_location
65           0.207                60   19.59                field
66           0.148                37   14.55                field
67           0.236                63   92.60                field
68           0.283                44   85.03                field
69           0.256               196  395.36                field
77           0.325                85  268.56                field

$`Baccharis pilularis`
   Sample number Location    Type Treatment   Size             Species
70            82      SME natural vegetated  small Baccharis pilularis
71            83      SME natural vegetated  small Baccharis pilularis
72            84      SME natural vegetated medium Baccharis pilularis
73            85      SME natural vegetated  small Baccharis pilularis
74            86      SME natural vegetated medium Baccharis pilularis
75            87      SME natural vegetated  large Baccharis pilularis
76            89      SME natural vegetated  large Baccharis pilularis
   Plant type Height Width_farthest Width_perpendicular Branch_length
70      shrub     45             34                  33          32.9
71      shrub     30             20                  19          20.3
72      shrub     54             45                  44          40.9
73      shrub     49             35                  20          29.3
74      shrub     48             74                  71          53.9
75      shrub     52             82                  68          45.2
76      shrub     71             72                  69          50.6
   Branch_diameter Branches_per_stem Leaves_per_branch Leaf_lmax Leaf_lmin
70           0.232                17              16.4      14.0       9.5
71           0.204                14              12.2      10.0       7.5
72           0.386                16              25.2      20.0       9.5
73           0.290                10              20.6      14.0      10.0
74           0.440                48              20.2      19.0      11.0
75           0.466                40              26.2      16.5      11.7
76           0.691                41              28.6      14.5       9.5
   Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg
70     12.40        19         8      13.0      0.10      0.08     0.084
71      8.80        12         8       9.0      0.07      0.11     0.090
72     14.50        55        11      25.8      0.05      0.10     0.068
73     11.90        22        14      17.8      0.08      0.06     0.070
74     14.00        16        11      13.6      0.10      0.06     0.082
75     14.04        47        30      39.6      0.07      0.10     0.080
76     11.60        24        13      19.6      0.07      0.05     0.056
   Biomass Measurement_location
70   27.43                  lab
71   13.95                  lab
72   86.63                  lab
73   28.76                  lab
74  166.61            field/lab
75  385.97                field
76  102.65                field

$`Chondropetalum tectorum`
   Sample number Location      Type Treatment   Size                 Species
60            70      SME biofilter vegetated  large Chondropetalum tectorum
61            71      SME biofilter vegetated  small Chondropetalum tectorum
62            72      SME biofilter vegetated  small Chondropetalum tectorum
63            73      SME biofilter vegetated medium Chondropetalum tectorum
64            74      SME biofilter vegetated medium Chondropetalum tectorum
78            90      SME biofilter vegetated  large Chondropetalum tectorum
   Plant type Height Width_farthest Width_perpendicular Branch_length
60      shrub  177.0            259                 160        158.90
61      shrub  120.5             58                  50         76.30
62      shrub  132.5            114                  24         83.80
63      shrub  189.0            170                  86        151.25
64      shrub  150.0            116                  62        141.40
78      shrub  180.0            210                 132        167.90
   Branch_diameter Basal_circ Stem_density Biomass Measurement_location
60           0.456      132.0          145 2083.04                field
61           0.466       65.0           40  114.86                field
62           0.457       60.0           20   64.38                field
63           0.418      131.0           60  761.40                field
64           0.396      124.3          130 2059.46                field
78           0.482      146.0          120 2350.90                field

$`Euphorbia spp.`
   Sample number Location      Type   Size        Species Plant type
17            17    OSLER biofilter  small Euphorbia spp.       forb
26            26    OSLER biofilter  large Euphorbia spp.       forb
27            27    OSLER biofilter medium Euphorbia spp.       forb
28            28      SIO biofilter  small Euphorbia spp.       forb
29            29      SIO biofilter  small Euphorbia spp.       forb
30            30      SIO biofilter  large Euphorbia spp.       forb
31            31      SIO biofilter  large Euphorbia spp.       forb
32            32      SIO biofilter medium Euphorbia spp.       forb
33            33      SIO biofilter medium Euphorbia spp.       forb
   Width_farthest Width_perpendicular Branch_length Branch_diameter
17            3.5                 1.0          1.54           0.036
26           13.0                10.0          4.42           0.074
27            7.2                 4.5          2.73           0.054
28            4.6                 2.8          2.13           0.053
29            3.7                 1.3          1.30           0.058
30           24.0                18.0         12.82           0.075
31           12.5                12.5          5.80           0.054
32            8.0                 6.2          2.83           0.051
33            8.0                 3.7          2.38           0.059
   Stem_diameter Stem_height Branches_per_stem Leaves_per_branch Leaf_lmax
17          0.03         1.0                 5              7.80      0.50
26          0.08         0.7                36             26.80      0.70
27          0.05         0.4                13             16.20      0.60
28          0.06         0.7                 4              9.75      0.40
29          0.08         0.4                 4              6.50      0.45
30          0.18         0.2               120             32.00      0.55
31          0.13         0.7                43             32.20      0.40
32          0.08         0.7                18             20.20      0.50
33          0.14         0.2                15             13.40      0.50
   Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax Leaf_tmin
17      0.25      0.42      0.40      0.15      0.26      0.01      0.01
26      0.20      0.43      0.50      0.20      0.32      0.02      0.01
27      0.20      0.38      0.40      0.20      0.30      0.01      0.01
28      0.20      0.31      0.40      0.15      0.27      0.02      0.01
29      0.20      0.32      0.35      0.20      0.26      0.01      0.01
30      0.30      0.44      0.50      0.25      0.38      0.02      0.01
31      0.15      0.27      0.30      0.15      0.23      0.01      0.01
32      0.20      0.34      0.40      0.15      0.26      0.01      0.01
33      0.15      0.32      0.40      0.15      0.26      0.01      0.01
   Leaf_tavg Biomass Measurement_location
17     0.010    0.01                  lab
26     0.012    0.24                  lab
27     0.010    0.08                  lab
28     0.013    0.01                  lab
29     0.010    0.01                  lab
30     0.017    1.63                  lab
31     0.010    0.49                  lab
32     0.010    0.13                  lab
33     0.010    0.12                  lab

$`Gnaphalium spp.`
   Sample number Location      Type Treatment   Size         Species Plant type
7              7    OSLER biofilter vegetated medium Gnaphalium spp.       forb
8              8    OSLER biofilter vegetated medium Gnaphalium spp.       forb
9              9    OSLER biofilter vegetated  small Gnaphalium spp.       forb
10            10    OSLER biofilter vegetated  small Gnaphalium spp.       forb
11            11    OSLER biofilter vegetated medium Gnaphalium spp.       forb
   Height Width_farthest Width_perpendicular Branch_length Branch_diameter
7    23.0            4.5                 4.3          2.62           0.055
8    28.0            3.0                 2.7          1.30           0.048
9    20.0            4.5                 2.6          3.55           0.066
10   15.0            6.0                 4.0          8.00           0.030
11   18.5            9.5                 5.5          6.30           0.092
   Stem_diameter Stem_height Stem_density Branches_per_stem Total_leaves
7           0.27       21.00            1                13           40
8           0.19       27.50            1                10           35
9           0.15       20.00            1                 7           60
10          0.22        5.30            1                 3           30
11          0.23        0.45            1                15          100
   Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax
7        2.8       1.1      1.98       0.3       0.1      0.21      0.04
8        3.4       1.0      2.21       0.5       0.1      0.23      0.03
9        2.8       1.0      1.92       0.5       0.1      0.21      0.03
10       2.4       1.0      1.27       0.2       0.1      0.12      0.02
11       1.5       0.5      1.12       0.2       0.1      0.12      0.03
   Leaf_tmin Leaf_tavg Biomass Measurement_location
7       0.02     0.030    0.73                field
8       0.10     0.024    0.50                field
9       0.01     0.210    0.35                field
10      0.01     0.014    0.21                field
11      0.01     0.023    1.14                field

$`Lactucca spp.`
   Sample number Location      Type  Size       Species Plant type Height
12            12    OSLER biofilter large Lactucca spp.       forb    2.0
13            13    OSLER biofilter small Lactucca spp.       forb    5.0
14            14    OSLER biofilter small Lactucca spp.       forb    3.2
15            15    OSLER biofilter small Lactucca spp.       forb    4.0
16            16    OSLER biofilter large Lactucca spp.       forb   29.0
   Width_farthest Width_perpendicular Total_leaves Leaf_lmax Leaf_lmin
12           15.0                  15           11       8.5       4.0
13            9.0                   7            7       6.0       2.2
14           12.0                   6            6       6.8       1.9
15            9.5                   6            4       7.5       3.6
16           15.0                   6           42      15.0       9.0
   Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg
12      6.50       2.7       1.3      2.08      0.09      0.04     0.059
13      4.10       2.0       1.2      1.56      0.05      0.02     0.027
14      4.48       2.0       1.0      1.58      0.04      0.02     0.033
15      6.15       1.9       1.0      1.43      0.04      0.03     0.038
16     11.22       4.0       1.0      2.36      0.15      0.06     0.103
   Biomass Measurement_location
12    0.31                field
13    0.05                field
14    0.03                field
15    0.03                field
16    2.35                  lab

$`Onetheria biennis`
   Sample number Location      Type   Treatment   Size           Species
20            20    ACTRI biofilter unvegetated  small Onetheria biennis
21            21    ACTRI biofilter unvegetated  small Onetheria biennis
22            22    ACTRI biofilter unvegetated  small Onetheria biennis
23            23    ACTRI biofilter unvegetated medium Onetheria biennis
24            24    ACTRI biofilter unvegetated medium Onetheria biennis
25            25    ACTRI biofilter unvegetated medium Onetheria biennis
43            43    ACTRI biofilter unvegetated  large Onetheria biennis
44            44    ACTRI biofilter unvegetated  large Onetheria biennis
45            45    ACTRI biofilter unvegetated  large Onetheria biennis
   Plant type Height Total_leaves Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax
20       forb    4.0            9       7.4       1.1      4.47       1.9
21       forb    4.2            9       7.3       0.9      4.28       1.9
22       forb    7.0           22       8.5       2.5      5.42       1.7
23       forb    9.5           18      17.0       2.5      9.01       2.9
24       forb   12.5           37      16.5       3.1     10.61       2.4
25       forb    6.5           18      18.5       2.7     10.11       2.5
43       forb   18.0           27      14.0       4.0     10.28       2.0
44       forb   17.0           28      14.0       4.5      9.17       2.3
45       forb   13.0           49      10.5       4.5      7.67       1.9
   Leaf_wmin Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg Biomass
20       0.2      1.17      0.06      0.02     0.039    0.09
21       0.2      1.19      0.06      0.03     0.043    0.10
22       0.8      1.26      0.08      0.02     0.056    0.40
23       0.8      1.97      0.09      0.04     0.069    0.66
24       0.6      1.51      0.08      0.06     0.070    1.22
25       0.7      1.62      0.10      0.05     0.066    1.01
43       0.8      1.61      0.08      0.04     0.058    5.25
44       1.0      1.63      0.07      0.05     0.059    6.66
45       1.1      1.60      0.06      0.04     0.054    6.20
   Measurement_location
20                  lab
21                  lab
22                  lab
23                  lab
24                  lab
25                  lab
43                  lab
44                  lab
45                  lab

$`Rhus integrifolia`
   Sample number Location    Type   Size           Species Plant type Height
93           110      SIO natural  small Rhus integrifolia      shrub     53
94           111      SIO natural medium Rhus integrifolia      shrub     80
95           112      SIO natural  small Rhus integrifolia      shrub     55
96           113      SIO natural  small Rhus integrifolia      shrub     37
97           114      SIO natural  large Rhus integrifolia      shrub    144
   Width_farthest Width_perpendicular Branch_length Branch_diameter
93             27                  38         27.50           0.445
94             78                  68         40.00           0.891
95             44                  29         21.15           0.397
96             36                  28         17.00           0.371
97            126                 104         69.15           1.146
   Stem_diameter Stem_height Stem_density Branches_per_stem Total_leaves
93          1.07        16.0            1                 6          104
94          2.71        12.0            1                50          687
95          1.28         6.5            1                11           94
96          1.97         3.0            1                 9           56
97          3.63         8.0            1                61          892
   Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax
93       5.5       2.3      3.89       3.7       1.6      2.74      0.06
94       6.4       2.4      4.79       4.3       1.6      3.17      0.10
95       5.9       3.2      4.73       3.8       2.2      3.14      0.07
96       5.5       2.2      3.99       3.7       1.5      2.31      0.07
97       5.3       2.7      4.10       4.0       2.0      2.98      0.08
   Leaf_tmin Leaf_tavg Biomass
93      0.05     0.054   49.58
94      0.05     0.078  556.47
95      0.05     0.057   55.20
96      0.03     0.056   36.56
97      0.05     0.071 1172.31

$`Salix spp.`
   Sample number Location      Type Treatment   Size    Species Plant type
46            46    ACTRI biofilter vegetated  small Salix spp.       tree
47            47    ACTRI biofilter vegetated  small Salix spp.       tree
48            48    ACTRI biofilter vegetated  small Salix spp.       tree
49            49    ACTRI biofilter vegetated medium Salix spp.       tree
50            50    ACTRI biofilter vegetated medium Salix spp.       tree
51            51    ACTRI biofilter vegetated medium Salix spp.       tree
52            52    ACTRI biofilter vegetated  large Salix spp.       tree
79            91    ACTRI biofilter vegetated  large Salix spp.       tree
80            92    ACTRI biofilter vegetated  large Salix spp.       tree
   Height Stem_diameter Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin
46     50          0.21       9.0       2.6      6.20       0.8      0.40
47     42          0.17       8.0       3.3      5.88       0.5      0.20
48     28          0.08       7.0       4.5      5.56       0.5      0.15
49    154          0.92      11.0       4.0      7.83       1.0      0.40
50    144          0.77      11.5       4.5      7.94       0.9      0.35
51    116          0.60      11.0       4.0      7.47       0.6      0.30
52    220          1.23      12.5       5.0      9.00       1.0      0.40
79    239          1.63      13.5       6.5      9.30       1.1      0.40
80    248          1.85      12.0       5.0      9.41       1.5      0.30
   Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg Biomass Measurement_location
46      0.57      0.04      0.03     0.032    1.17                  lab
47      0.32      0.04      0.02     0.024    0.71                  lab
48      0.36      0.03      0.02     0.025    0.31                  lab
49      0.67      0.07      0.04     0.053   27.27                  lab
50      0.59      0.08      0.50     0.060   20.90                  lab
51      0.47      0.06      0.03     0.051    9.61                  lab
52      0.62      0.08      0.05     0.066   72.53                  lab
79      0.89      0.06      0.02     0.046  154.68            field/lab
80      0.90      0.06      0.03     0.042  135.22            field/lab

$`Solidago spp.`
   Sample number Location      Type Treatment   Size       Species Plant type
81            93  Sanford biofilter vegetated  large Solidago spp.       forb
82            94  Sanford biofilter vegetated  large Solidago spp.       forb
83            95  Sanford biofilter vegetated medium Solidago spp.       forb
84            96  Sanford biofilter vegetated medium Solidago spp.       forb
85            97  Sanford biofilter vegetated  small Solidago spp.       forb
86            98  Sanford biofilter vegetated  small Solidago spp.       forb
   Height Width_farthest Width_perpendicular Stem_diameter Stem_height
81   11.5           12.5                10.0          0.08         0.4
82    9.0           11.0                 7.0          0.12         4.5
83    6.5            8.0                 5.0          0.07         1.5
84    8.5            8.5                 4.5          0.09         3.0
85    4.5            4.0                 3.5          0.09         0.8
86    5.5            4.5                 2.0          0.09         2.3
   Total_leaves Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg
81            9      11.0       4.0      7.59       3.0       0.9      2.13
82            9       8.0       3.0      5.64       2.3       0.7      1.57
83           10       6.0       1.4      4.18       1.5       0.2      1.08
84            8       6.0       0.9      3.64       1.2       0.2      0.75
85            5       4.2       3.0      3.22       1.4       0.7      1.04
86            5       5.2       2.7      3.90       1.9       1.1      1.56
   Leaf_tmax Leaf_tmin Leaf_tavg Biomass
81      0.05      0.03     0.032    0.47
82      0.03      0.02     0.027    0.25
83      0.02      0.01     0.019    0.14
84      0.03      0.01     0.019    0.07
85      0.03      0.02     0.024    0.04
86      0.04      0.02     0.030    0.09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The below is how you test for normality by species for the 11 species we are going to study. </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(spec)) {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[i]]<span class="sc">$</span>Biomass))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.84968, p-value = 0.07392


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.85006, p-value = 0.1576


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.79028, p-value = 0.03278


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.83149, p-value = 0.1106


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.61953, p-value = 0.0001622


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.94689, p-value = 0.715


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.63367, p-value = 0.001693


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.76286, p-value = 0.007639


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.77621, p-value = 0.05113


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.78122, p-value = 0.01244


    Shapiro-Wilk normality test

data:  spec[[i]]$Biomass
W = 0.84275, p-value = 0.1374</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or this, to test for normality for each species individually one at a time. </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Aptenia cordifolia"</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Aptenia cordifolia"]]$Biomass
W = 0.84968, p-value = 0.07392</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Artemisia californica"</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Artemisia californica"]]$Biomass
W = 0.85006, p-value = 0.1576</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Baccharis pilularis"</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Baccharis pilularis"]]$Biomass
W = 0.79028, p-value = 0.03278</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Chondropetalum tectorum"</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Chondropetalum tectorum"]]$Biomass
W = 0.83149, p-value = 0.1106</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Euphorbia spp."</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Euphorbia spp."]]$Biomass
W = 0.61953, p-value = 0.0001622</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Gnaphalium spp."</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Gnaphalium spp."]]$Biomass
W = 0.94689, p-value = 0.715</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Lactucca spp."</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Lactucca spp."]]$Biomass
W = 0.63367, p-value = 0.001693</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Onetheria biennis"</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Onetheria biennis"]]$Biomass
W = 0.76286, p-value = 0.007639</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Rhus integrifolia"</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Rhus integrifolia"]]$Biomass
W = 0.77621, p-value = 0.05113</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Salix spp."</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Salix spp."]]$Biomass
W = 0.78122, p-value = 0.01244</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Solidago spp."</span>]]<span class="sc">$</span>Biomass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Solidago spp."]]$Biomass
W = 0.84275, p-value = 0.1374</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From the test, we observe: </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Normally distributed data (p-value &gt; 0.05): Aptenia cordifolia, Artemisia californica, Chondropetalum tectorum, Gnaphaluim spp., Rhus integrifolia, Solidago spp.</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Not normally distributed data (p-value &lt; 0.05): Baccharis pilularis, Euphorbia spp., Lactucca spp., Onetheria biennis, Salix spp.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="aptenia-cordifolia" class="level1">
<h1>1. Aptenia cordifolia</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at each species and its morphological measurements to see which measurement(s) would be a good biomass indicator for each species. Then we can test with a regular linear regression model for normally distributed data. </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>spec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Aptenia cordifolia`
   Sample number Location   Type Treatment   Size            Species
1              1      SME garden vegetated  small Aptenia cordifolia
2              2      SME garden vegetated  small Aptenia cordifolia
3              3      SME garden vegetated  small Aptenia cordifolia
4              4      SME garden vegetated  large Aptenia cordifolia
5              5      SME garden vegetated  large Aptenia cordifolia
6              6      SME garden vegetated  large Aptenia cordifolia
57            57    OSLER garden vegetated medium Aptenia cordifolia
58            58    OSLER garden vegetated medium Aptenia cordifolia
59            59    OSLER garden vegetated medium Aptenia cordifolia
   Width_farthest Width_perpendicular Branch_length Branch_diameter
1            17.5                14.0          4.50           0.430
2            10.0                 7.5          3.17           0.400
3            12.0                 9.5          3.75           0.350
4            59.5                30.0         13.00           0.370
5            44.5                22.0         11.00           0.460
6            84.0                35.0         34.85           0.320
57           68.0                39.0         20.10           0.336
58           58.5                47.0         23.34           0.376
59           32.0                24.0         11.35           0.446
   Leaves_per_branch Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin
1                8.4       3.5       1.5      2.48       2.3       1.1
2                7.4       3.0       1.0      2.07       2.0       0.8
3               10.5       3.8       1.8      2.79       2.4       1.1
4               28.0       5.3       1.8      3.44       3.2       1.3
5               18.2       3.5       1.5      2.61       2.0       0.8
6               22.0       4.5       1.4      2.73       3.0       1.0
57              17.0       4.0       1.6      2.93       2.0       1.0
58              16.2       3.7       1.7      2.57       2.2       1.0
59              21.2       3.2       1.5      2.41       1.8       0.9
   Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg Biomass Measurement_location
1       1.79      0.27      0.16     0.210    3.34                field
2       1.46      0.26      0.09     0.160    1.46                field
3       1.78      0.28      0.12     0.160    1.36                field
4       2.12      0.20      0.14     0.160   11.79                field
5       1.60      0.27      0.11     0.180   14.45                field
6       1.84      0.17      0.09     0.130   29.83                field
57      1.52      0.16      0.10     0.120    6.69                field
58      1.53      0.17      0.12     0.130   12.18                field
59      1.36      0.24      0.14     0.207    6.75                field

$`Artemisia californica`
   Sample number Location    Type Treatment   Size               Species
65            77      SME natural vegetated  small Artemisia californica
66            78      SME natural vegetated  small Artemisia californica
67            79      SME natural vegetated medium Artemisia californica
68            80      SME natural vegetated medium Artemisia californica
69            81      SME natural vegetated  large Artemisia californica
77            88      SME natural vegetated  large Artemisia californica
   Plant type Height Width_farthest Width_perpendicular Branch_length
65      shrub   31.0             36                28.5         18.05
66      shrub   32.0             47                31.5         17.20
67      shrub   52.5             50                51.0         44.80
68      shrub   60.0             55                46.0         49.95
69      shrub   66.0            100                88.0         53.10
77      shrub   64.0             84                64.0         43.80
   Branch_diameter Branches_per_stem Biomass Measurement_location
65           0.207                60   19.59                field
66           0.148                37   14.55                field
67           0.236                63   92.60                field
68           0.283                44   85.03                field
69           0.256               196  395.36                field
77           0.325                85  268.56                field

$`Baccharis pilularis`
   Sample number Location    Type Treatment   Size             Species
70            82      SME natural vegetated  small Baccharis pilularis
71            83      SME natural vegetated  small Baccharis pilularis
72            84      SME natural vegetated medium Baccharis pilularis
73            85      SME natural vegetated  small Baccharis pilularis
74            86      SME natural vegetated medium Baccharis pilularis
75            87      SME natural vegetated  large Baccharis pilularis
76            89      SME natural vegetated  large Baccharis pilularis
   Plant type Height Width_farthest Width_perpendicular Branch_length
70      shrub     45             34                  33          32.9
71      shrub     30             20                  19          20.3
72      shrub     54             45                  44          40.9
73      shrub     49             35                  20          29.3
74      shrub     48             74                  71          53.9
75      shrub     52             82                  68          45.2
76      shrub     71             72                  69          50.6
   Branch_diameter Branches_per_stem Leaves_per_branch Leaf_lmax Leaf_lmin
70           0.232                17              16.4      14.0       9.5
71           0.204                14              12.2      10.0       7.5
72           0.386                16              25.2      20.0       9.5
73           0.290                10              20.6      14.0      10.0
74           0.440                48              20.2      19.0      11.0
75           0.466                40              26.2      16.5      11.7
76           0.691                41              28.6      14.5       9.5
   Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg
70     12.40        19         8      13.0      0.10      0.08     0.084
71      8.80        12         8       9.0      0.07      0.11     0.090
72     14.50        55        11      25.8      0.05      0.10     0.068
73     11.90        22        14      17.8      0.08      0.06     0.070
74     14.00        16        11      13.6      0.10      0.06     0.082
75     14.04        47        30      39.6      0.07      0.10     0.080
76     11.60        24        13      19.6      0.07      0.05     0.056
   Biomass Measurement_location
70   27.43                  lab
71   13.95                  lab
72   86.63                  lab
73   28.76                  lab
74  166.61            field/lab
75  385.97                field
76  102.65                field

$`Chondropetalum tectorum`
   Sample number Location      Type Treatment   Size                 Species
60            70      SME biofilter vegetated  large Chondropetalum tectorum
61            71      SME biofilter vegetated  small Chondropetalum tectorum
62            72      SME biofilter vegetated  small Chondropetalum tectorum
63            73      SME biofilter vegetated medium Chondropetalum tectorum
64            74      SME biofilter vegetated medium Chondropetalum tectorum
78            90      SME biofilter vegetated  large Chondropetalum tectorum
   Plant type Height Width_farthest Width_perpendicular Branch_length
60      shrub  177.0            259                 160        158.90
61      shrub  120.5             58                  50         76.30
62      shrub  132.5            114                  24         83.80
63      shrub  189.0            170                  86        151.25
64      shrub  150.0            116                  62        141.40
78      shrub  180.0            210                 132        167.90
   Branch_diameter Basal_circ Stem_density Biomass Measurement_location
60           0.456      132.0          145 2083.04                field
61           0.466       65.0           40  114.86                field
62           0.457       60.0           20   64.38                field
63           0.418      131.0           60  761.40                field
64           0.396      124.3          130 2059.46                field
78           0.482      146.0          120 2350.90                field

$`Euphorbia spp.`
   Sample number Location      Type   Size        Species Plant type
17            17    OSLER biofilter  small Euphorbia spp.       forb
26            26    OSLER biofilter  large Euphorbia spp.       forb
27            27    OSLER biofilter medium Euphorbia spp.       forb
28            28      SIO biofilter  small Euphorbia spp.       forb
29            29      SIO biofilter  small Euphorbia spp.       forb
30            30      SIO biofilter  large Euphorbia spp.       forb
31            31      SIO biofilter  large Euphorbia spp.       forb
32            32      SIO biofilter medium Euphorbia spp.       forb
33            33      SIO biofilter medium Euphorbia spp.       forb
   Width_farthest Width_perpendicular Branch_length Branch_diameter
17            3.5                 1.0          1.54           0.036
26           13.0                10.0          4.42           0.074
27            7.2                 4.5          2.73           0.054
28            4.6                 2.8          2.13           0.053
29            3.7                 1.3          1.30           0.058
30           24.0                18.0         12.82           0.075
31           12.5                12.5          5.80           0.054
32            8.0                 6.2          2.83           0.051
33            8.0                 3.7          2.38           0.059
   Stem_diameter Stem_height Branches_per_stem Leaves_per_branch Leaf_lmax
17          0.03         1.0                 5              7.80      0.50
26          0.08         0.7                36             26.80      0.70
27          0.05         0.4                13             16.20      0.60
28          0.06         0.7                 4              9.75      0.40
29          0.08         0.4                 4              6.50      0.45
30          0.18         0.2               120             32.00      0.55
31          0.13         0.7                43             32.20      0.40
32          0.08         0.7                18             20.20      0.50
33          0.14         0.2                15             13.40      0.50
   Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax Leaf_tmin
17      0.25      0.42      0.40      0.15      0.26      0.01      0.01
26      0.20      0.43      0.50      0.20      0.32      0.02      0.01
27      0.20      0.38      0.40      0.20      0.30      0.01      0.01
28      0.20      0.31      0.40      0.15      0.27      0.02      0.01
29      0.20      0.32      0.35      0.20      0.26      0.01      0.01
30      0.30      0.44      0.50      0.25      0.38      0.02      0.01
31      0.15      0.27      0.30      0.15      0.23      0.01      0.01
32      0.20      0.34      0.40      0.15      0.26      0.01      0.01
33      0.15      0.32      0.40      0.15      0.26      0.01      0.01
   Leaf_tavg Biomass Measurement_location
17     0.010    0.01                  lab
26     0.012    0.24                  lab
27     0.010    0.08                  lab
28     0.013    0.01                  lab
29     0.010    0.01                  lab
30     0.017    1.63                  lab
31     0.010    0.49                  lab
32     0.010    0.13                  lab
33     0.010    0.12                  lab

$`Gnaphalium spp.`
   Sample number Location      Type Treatment   Size         Species Plant type
7              7    OSLER biofilter vegetated medium Gnaphalium spp.       forb
8              8    OSLER biofilter vegetated medium Gnaphalium spp.       forb
9              9    OSLER biofilter vegetated  small Gnaphalium spp.       forb
10            10    OSLER biofilter vegetated  small Gnaphalium spp.       forb
11            11    OSLER biofilter vegetated medium Gnaphalium spp.       forb
   Height Width_farthest Width_perpendicular Branch_length Branch_diameter
7    23.0            4.5                 4.3          2.62           0.055
8    28.0            3.0                 2.7          1.30           0.048
9    20.0            4.5                 2.6          3.55           0.066
10   15.0            6.0                 4.0          8.00           0.030
11   18.5            9.5                 5.5          6.30           0.092
   Stem_diameter Stem_height Stem_density Branches_per_stem Total_leaves
7           0.27       21.00            1                13           40
8           0.19       27.50            1                10           35
9           0.15       20.00            1                 7           60
10          0.22        5.30            1                 3           30
11          0.23        0.45            1                15          100
   Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax
7        2.8       1.1      1.98       0.3       0.1      0.21      0.04
8        3.4       1.0      2.21       0.5       0.1      0.23      0.03
9        2.8       1.0      1.92       0.5       0.1      0.21      0.03
10       2.4       1.0      1.27       0.2       0.1      0.12      0.02
11       1.5       0.5      1.12       0.2       0.1      0.12      0.03
   Leaf_tmin Leaf_tavg Biomass Measurement_location
7       0.02     0.030    0.73                field
8       0.10     0.024    0.50                field
9       0.01     0.210    0.35                field
10      0.01     0.014    0.21                field
11      0.01     0.023    1.14                field

$`Lactucca spp.`
   Sample number Location      Type  Size       Species Plant type Height
12            12    OSLER biofilter large Lactucca spp.       forb    2.0
13            13    OSLER biofilter small Lactucca spp.       forb    5.0
14            14    OSLER biofilter small Lactucca spp.       forb    3.2
15            15    OSLER biofilter small Lactucca spp.       forb    4.0
16            16    OSLER biofilter large Lactucca spp.       forb   29.0
   Width_farthest Width_perpendicular Total_leaves Leaf_lmax Leaf_lmin
12           15.0                  15           11       8.5       4.0
13            9.0                   7            7       6.0       2.2
14           12.0                   6            6       6.8       1.9
15            9.5                   6            4       7.5       3.6
16           15.0                   6           42      15.0       9.0
   Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg
12      6.50       2.7       1.3      2.08      0.09      0.04     0.059
13      4.10       2.0       1.2      1.56      0.05      0.02     0.027
14      4.48       2.0       1.0      1.58      0.04      0.02     0.033
15      6.15       1.9       1.0      1.43      0.04      0.03     0.038
16     11.22       4.0       1.0      2.36      0.15      0.06     0.103
   Biomass Measurement_location
12    0.31                field
13    0.05                field
14    0.03                field
15    0.03                field
16    2.35                  lab

$`Onetheria biennis`
   Sample number Location      Type   Treatment   Size           Species
20            20    ACTRI biofilter unvegetated  small Onetheria biennis
21            21    ACTRI biofilter unvegetated  small Onetheria biennis
22            22    ACTRI biofilter unvegetated  small Onetheria biennis
23            23    ACTRI biofilter unvegetated medium Onetheria biennis
24            24    ACTRI biofilter unvegetated medium Onetheria biennis
25            25    ACTRI biofilter unvegetated medium Onetheria biennis
43            43    ACTRI biofilter unvegetated  large Onetheria biennis
44            44    ACTRI biofilter unvegetated  large Onetheria biennis
45            45    ACTRI biofilter unvegetated  large Onetheria biennis
   Plant type Height Total_leaves Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax
20       forb    4.0            9       7.4       1.1      4.47       1.9
21       forb    4.2            9       7.3       0.9      4.28       1.9
22       forb    7.0           22       8.5       2.5      5.42       1.7
23       forb    9.5           18      17.0       2.5      9.01       2.9
24       forb   12.5           37      16.5       3.1     10.61       2.4
25       forb    6.5           18      18.5       2.7     10.11       2.5
43       forb   18.0           27      14.0       4.0     10.28       2.0
44       forb   17.0           28      14.0       4.5      9.17       2.3
45       forb   13.0           49      10.5       4.5      7.67       1.9
   Leaf_wmin Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg Biomass
20       0.2      1.17      0.06      0.02     0.039    0.09
21       0.2      1.19      0.06      0.03     0.043    0.10
22       0.8      1.26      0.08      0.02     0.056    0.40
23       0.8      1.97      0.09      0.04     0.069    0.66
24       0.6      1.51      0.08      0.06     0.070    1.22
25       0.7      1.62      0.10      0.05     0.066    1.01
43       0.8      1.61      0.08      0.04     0.058    5.25
44       1.0      1.63      0.07      0.05     0.059    6.66
45       1.1      1.60      0.06      0.04     0.054    6.20
   Measurement_location
20                  lab
21                  lab
22                  lab
23                  lab
24                  lab
25                  lab
43                  lab
44                  lab
45                  lab

$`Rhus integrifolia`
   Sample number Location    Type   Size           Species Plant type Height
93           110      SIO natural  small Rhus integrifolia      shrub     53
94           111      SIO natural medium Rhus integrifolia      shrub     80
95           112      SIO natural  small Rhus integrifolia      shrub     55
96           113      SIO natural  small Rhus integrifolia      shrub     37
97           114      SIO natural  large Rhus integrifolia      shrub    144
   Width_farthest Width_perpendicular Branch_length Branch_diameter
93             27                  38         27.50           0.445
94             78                  68         40.00           0.891
95             44                  29         21.15           0.397
96             36                  28         17.00           0.371
97            126                 104         69.15           1.146
   Stem_diameter Stem_height Stem_density Branches_per_stem Total_leaves
93          1.07        16.0            1                 6          104
94          2.71        12.0            1                50          687
95          1.28         6.5            1                11           94
96          1.97         3.0            1                 9           56
97          3.63         8.0            1                61          892
   Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg Leaf_tmax
93       5.5       2.3      3.89       3.7       1.6      2.74      0.06
94       6.4       2.4      4.79       4.3       1.6      3.17      0.10
95       5.9       3.2      4.73       3.8       2.2      3.14      0.07
96       5.5       2.2      3.99       3.7       1.5      2.31      0.07
97       5.3       2.7      4.10       4.0       2.0      2.98      0.08
   Leaf_tmin Leaf_tavg Biomass
93      0.05     0.054   49.58
94      0.05     0.078  556.47
95      0.05     0.057   55.20
96      0.03     0.056   36.56
97      0.05     0.071 1172.31

$`Salix spp.`
   Sample number Location      Type Treatment   Size    Species Plant type
46            46    ACTRI biofilter vegetated  small Salix spp.       tree
47            47    ACTRI biofilter vegetated  small Salix spp.       tree
48            48    ACTRI biofilter vegetated  small Salix spp.       tree
49            49    ACTRI biofilter vegetated medium Salix spp.       tree
50            50    ACTRI biofilter vegetated medium Salix spp.       tree
51            51    ACTRI biofilter vegetated medium Salix spp.       tree
52            52    ACTRI biofilter vegetated  large Salix spp.       tree
79            91    ACTRI biofilter vegetated  large Salix spp.       tree
80            92    ACTRI biofilter vegetated  large Salix spp.       tree
   Height Stem_diameter Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin
46     50          0.21       9.0       2.6      6.20       0.8      0.40
47     42          0.17       8.0       3.3      5.88       0.5      0.20
48     28          0.08       7.0       4.5      5.56       0.5      0.15
49    154          0.92      11.0       4.0      7.83       1.0      0.40
50    144          0.77      11.5       4.5      7.94       0.9      0.35
51    116          0.60      11.0       4.0      7.47       0.6      0.30
52    220          1.23      12.5       5.0      9.00       1.0      0.40
79    239          1.63      13.5       6.5      9.30       1.1      0.40
80    248          1.85      12.0       5.0      9.41       1.5      0.30
   Leaf_wavg Leaf_tmax Leaf_tmin Leaf_tavg Biomass Measurement_location
46      0.57      0.04      0.03     0.032    1.17                  lab
47      0.32      0.04      0.02     0.024    0.71                  lab
48      0.36      0.03      0.02     0.025    0.31                  lab
49      0.67      0.07      0.04     0.053   27.27                  lab
50      0.59      0.08      0.50     0.060   20.90                  lab
51      0.47      0.06      0.03     0.051    9.61                  lab
52      0.62      0.08      0.05     0.066   72.53                  lab
79      0.89      0.06      0.02     0.046  154.68            field/lab
80      0.90      0.06      0.03     0.042  135.22            field/lab

$`Solidago spp.`
   Sample number Location      Type Treatment   Size       Species Plant type
81            93  Sanford biofilter vegetated  large Solidago spp.       forb
82            94  Sanford biofilter vegetated  large Solidago spp.       forb
83            95  Sanford biofilter vegetated medium Solidago spp.       forb
84            96  Sanford biofilter vegetated medium Solidago spp.       forb
85            97  Sanford biofilter vegetated  small Solidago spp.       forb
86            98  Sanford biofilter vegetated  small Solidago spp.       forb
   Height Width_farthest Width_perpendicular Stem_diameter Stem_height
81   11.5           12.5                10.0          0.08         0.4
82    9.0           11.0                 7.0          0.12         4.5
83    6.5            8.0                 5.0          0.07         1.5
84    8.5            8.5                 4.5          0.09         3.0
85    4.5            4.0                 3.5          0.09         0.8
86    5.5            4.5                 2.0          0.09         2.3
   Total_leaves Leaf_lmax Leaf_lmin Leaf_lavg Leaf_wmax Leaf_wmin Leaf_wavg
81            9      11.0       4.0      7.59       3.0       0.9      2.13
82            9       8.0       3.0      5.64       2.3       0.7      1.57
83           10       6.0       1.4      4.18       1.5       0.2      1.08
84            8       6.0       0.9      3.64       1.2       0.2      0.75
85            5       4.2       3.0      3.22       1.4       0.7      1.04
86            5       5.2       2.7      3.90       1.9       1.1      1.56
   Leaf_tmax Leaf_tmin Leaf_tavg Biomass
81      0.05      0.03     0.032    0.47
82      0.03      0.02     0.027    0.25
83      0.02      0.01     0.019    0.14
84      0.03      0.01     0.019    0.07
85      0.03      0.02     0.024    0.04
86      0.04      0.02     0.030    0.09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also use covariance matrix to see the correlations between two variables in each species. This is an easier way to see which characteristics have the highest correlation with biomass. In our case we will only focus on the relationship the biomass measurements have with each variable of the morphological characteristics.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance matrix</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We create new data with only the numeric columns.</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>numerical_data <span class="ot">&lt;-</span> spec[[<span class="st">"Aptenia cordifolia"</span>]][, <span class="dv">8</span><span class="sc">:</span><span class="dv">21</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># This is to normalize the new data we just created.</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>data_normalized <span class="ot">&lt;-</span> <span class="fu">scale</span>(numerical_data)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_normalized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Width_perpendicular Branch_length Branch_diameter Leaves_per_branch
1          -0.8328213   -0.89143848       0.8554535        -1.1940027
2          -1.3104688   -1.01762721       0.2508136        -1.3406060
3          -1.1635004   -0.96259754      -0.7569196        -0.8861357
4           0.3429264   -0.08496918      -0.3538263         1.6794226
5          -0.2449474   -0.27472667       1.4600935         0.2427100
6           0.7103476    1.98813131      -1.3615596         0.7998026
    Leaf_lmax  Leaf_lmin  Leaf_lavg  Leaf_wmax  Leaf_wmin  Leaf_wavg  Leaf_tmax
1 -0.47377937 -0.1360828 -0.4998702 -0.0463926  0.6324555  0.5229323  0.9245638
2 -1.18444842 -2.1773242 -1.5785375 -0.6726927 -1.2649111 -0.8762649  0.7216108
3 -0.04737794  1.0886621  0.3157075  0.1623741  0.6324555  0.4805324  1.1275168
4  2.08462923  1.0886621  2.0257898  1.8325077  1.8973666  1.9221295 -0.4961074
5 -0.47377937 -0.1360828 -0.1578537 -0.6726927 -1.2649111 -0.2826661  0.9245638
6  0.94755874 -0.5443311  0.1578537  1.4149743  0.0000000  0.7349319 -1.1049665
    Leaf_tmin   Leaf_tavg    Biomass
1  1.69812336  1.47799218 -0.7213311
2 -1.19327588 -0.05802741 -0.9325254
3  0.04589523 -0.05802741 -0.9437592
4  0.87200930 -0.05802741  0.2279201
5 -0.36716181  0.55638043  0.5267377
6 -1.19327588 -0.97963916  2.2544872</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use this to compute the correlation matrix and plot it using ggplot.</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_normalized)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_A.cordifolia-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher value means there's positive correlation between the two variables</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Value closer to -1 means they are more negatively correlated. </span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Branch length shows the darkest red, meaning it has the highest value closer to 1. So now I use regression analysis to check for its R-squared value.</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Aptenia cordifolia: test for branch length measurements</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Biomass <span class="sc">~</span> Branch_length,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span> spec [[<span class="st">"Aptenia cordifolia"</span>]])</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Biomass ~ Branch_length, data = spec[["Aptenia cordifolia"]])

Residuals:
    Min      1Q  Median      3Q     Max 
-7.6174 -1.1459 -0.4419  2.6851  6.8106 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)    -0.4209     2.7119  -0.155  0.88104   
Branch_length   0.7328     0.1587   4.616  0.00244 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.732 on 7 degrees of freedom
Multiple R-squared:  0.7527,    Adjusted R-squared:  0.7174 
F-statistic: 21.31 on 1 and 7 DF,  p-value: 0.002438</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.7172 and p-value is 0.002438, which means that the model relatively explains the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Aptenia cordifolia.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Aptenia cordifolia"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Branch_length, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span>      <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Branch Length (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Branch Length vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Aptenia cordifolia"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_A.cordifolia-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>a.cordifolia <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Aptenia cordifolia"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Branch_length, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Branch Length (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Branch Length vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Aptenia cordifolia"</span>))))</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"1_A.cordifolia_branchlength.png"</span>, results_path), a.cordifolia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="artemisia-californica" class="level1">
<h1>2. Artemisia californica</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance matrix</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We create new data with only the numeric columns.</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>numerical_data <span class="ot">&lt;-</span> spec[[<span class="st">"Artemisia californica"</span>]][, <span class="dv">8</span><span class="sc">:</span><span class="dv">14</span>]</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is to normalize the new data we just created.</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>data_normalized <span class="ot">&lt;-</span> <span class="fu">scale</span>(numerical_data)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_normalized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Height Width_farthest Width_perpendicular Branch_length Branch_diameter
65 -1.2656243     -1.0575749         -1.03945844    -1.2348701      -0.5779965
66 -1.2020783     -0.6101393         -0.90387691    -1.2879716      -1.5386105
67  0.1006145     -0.4881115         -0.02259692     0.4362652      -0.1058304
68  0.5772094     -0.2847317         -0.24856615     0.7579978       0.6594045
69  0.9584853      1.5456863          1.64957536     0.9547857       0.2198015
77  0.8313934      0.8948710          0.56492307     0.3737929       1.3432314
   Branches_per_stem    Biomass
65       -0.35406645 -0.8259285
66       -0.74495581 -0.8588719
67       -0.30308088 -0.3487060
68       -0.62598948 -0.3981865
69        1.95727934  1.6302542
77        0.07081329  0.8014388</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use this to compute the correlation matrix and plot it using ggplot.</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_normalized)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_A.californica-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher value means there's positive correlation between the two variables</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Value closer to -1 means they are more negatively correlated. </span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Width farthest and width perpendicular show the darkest red, meaning they have the highest values closer to 1. So now I use regression analysis to check for its R-squared value.</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Artemisia californica: test for width farthest measurements</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Biomass <span class="sc">~</span> Width_farthest,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span> spec[[<span class="st">"Artemisia californica"</span>]])</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Biomass ~ Width_farthest, data = spec[["Artemisia californica"]])

Residuals:
    65     66     67     68     69     77 
 32.79 -39.58  20.11 -18.07  16.81 -12.05 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -233.5606    36.9719  -6.317  0.00321 ** 
Width_farthest    6.1211     0.5607  10.917  0.00040 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 30.82 on 4 degrees of freedom
Multiple R-squared:  0.9675,    Adjusted R-squared:  0.9594 
F-statistic: 119.2 on 1 and 4 DF,  p-value: 0.0003998</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.9594 and p-value is 0.0003998, which means that the model does explain the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Artemisia californica since it has the highest R-squared value.</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Artemisia californica"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Width_farthest, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Width (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Width vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Artemisia californica"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_A.californica-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>a.californica <span class="ot">&lt;-</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Artemisia californica"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Width_farthest, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Width (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Width vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Artemisia californica"</span>))))</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"2_A.californica_width.png"</span>, results_path), a.californica)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="chondropetalum-tectorum" class="level1">
<h1>3. Chondropetalum tectorum</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance matrix</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We create new data with only the numeric columns.</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>numerical_data <span class="ot">&lt;-</span> spec[[<span class="st">"Chondropetalum tectorum"</span>]][, <span class="dv">8</span><span class="sc">:</span><span class="dv">15</span>]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is to normalize the new data we just created.</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>data_normalized <span class="ot">&lt;-</span> <span class="fu">scale</span>(numerical_data)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_normalized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Height Width_farthest Width_perpendicular Branch_length Branch_diameter
60  0.6720763      1.4306882         1.440864339     0.7302758       0.3152297
61 -1.3441527     -1.3211619        -0.691356432    -1.3515458       0.6252917
62 -0.9159271     -0.5544773        -1.195335886    -1.1625184       0.3462359
63  1.1003020      0.2122073         0.006461275     0.5374679      -0.8630059
64 -0.2914313     -0.5270957        -0.458750529     0.2892119      -1.5451423
78  0.7791328      0.7598392         0.898117233     0.9571087       1.1213909
   Basal_circ Stem_density    Biomass
60  0.5976852    1.1294626  0.8052372
61 -1.1993937   -0.8749358 -1.0724750
62 -1.3335041   -1.2567260 -1.1206347
63  0.5708631   -0.4931456 -0.4556534
64  0.3911552    0.8431200  0.7827410
78  0.9731942    0.6522249  1.0607849</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use this to compute the correlation matrix and plot it using ggplot.</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_normalized)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_C.tectorum-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher value means there's positive correlation between the two variables</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Value closer to -1 means they are more negatively correlated. </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Stem density shows the darkest red, meaning it has the highest values closer to 1. So now I use regression analysis to check for its R-squared value.</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Chondropetalum tectorum : test for stem density measurements</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Biomass <span class="sc">~</span> Stem_density,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span> spec[[<span class="st">"Chondropetalum tectorum"</span>]])</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Biomass ~ Stem_density, data = spec[["Chondropetalum tectorum"]])

Residuals:
     60      61      62      63      64      78 
-300.23 -237.75   98.57   22.00  -33.71  451.12 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  -420.980    252.172  -1.669  0.17036   
Stem_density   19.340      2.566   7.535  0.00166 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 300.6 on 4 degrees of freedom
Multiple R-squared:  0.9342,    Adjusted R-squared:  0.9177 
F-statistic: 56.78 on 1 and 4 DF,  p-value: 0.001661</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.9177 and p-value is 0.001661, which means that the model does explain the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Chondropetalum tectorum since it has the highest R-squared value.</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Chondropetalum tectorum"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Stem_density, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Stem Density (n)"</span>) <span class="sc">+</span> </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Stem Density vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Chondropetalum tectorum"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_C.tectorum-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>c.tectorum <span class="ot">&lt;-</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Chondropetalum tectorum"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Stem_density, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Stem Density (n)"</span>) <span class="sc">+</span> </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Stem Density vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Chondropetalum tectorum"</span>))))</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"3_C.tectorum_density.png"</span>, results_path), c.tectorum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="gnaphalium-spp." class="level1">
<h1>4. Gnaphalium spp.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance matrix</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We create new data with only the numeric columns.</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>numerical_data <span class="ot">&lt;-</span> spec[[<span class="st">"Gnaphalium spp."</span>]][, <span class="dv">8</span><span class="sc">:</span><span class="dv">27</span>]</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is to normalize the new data we just created.</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>data_normalized <span class="ot">&lt;-</span> <span class="fu">scale</span>(numerical_data)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_normalized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Height Width_farthest Width_perpendicular Branch_length Branch_diameter
7   0.4282149     -0.4040610           0.3976596    -0.6325317      -0.1392358
8   1.4477741     -1.0101525          -0.9278724    -1.1140437      -0.4438140
9  -0.1835207     -0.4040610          -1.0107181    -0.2932846       0.3393872
10 -1.2030799      0.2020305           0.1491223     1.3299945      -1.2270151
11 -0.4893884      1.6162441           1.3918086     0.7098654       1.4706777
   Stem_diameter Stem_height Stem_density Branches_per_stem Total_leaves
7      1.2904831   0.5378774          NaN        0.71205164   -0.4539797
8     -0.4894936   1.1063658          NaN        0.08377078   -0.6285873
9     -1.3794819   0.4504177          NaN       -0.54451008    0.2444506
10     0.1779977  -0.8352406          NaN       -1.38221790   -0.8031948
11     0.4004947  -1.2594204          NaN        1.13090555    1.6413112
    Leaf_lmax  Leaf_lmin  Leaf_lavg  Leaf_wmax Leaf_wmin  Leaf_wavg Leaf_tmax
7   0.3136463  0.7539370  0.5876210 -0.2637522       NaN  0.5973227  1.414214
8   1.1690452  0.3350831  1.0703096  1.0550088       NaN  0.9706494  0.000000
9   0.3136463  0.3350831  0.4617022  1.0550088       NaN  0.5973227  0.000000
10 -0.2566197  0.3350831 -0.9024179 -0.9231327       NaN -1.0826474 -1.414214
11 -1.5397181 -1.7591864 -1.2172148 -0.9231327       NaN -1.0826474  0.000000
    Leaf_tmin  Leaf_tavg    Biomass
7  -0.2540003 -0.3597993  0.3948096
8   1.7780018 -0.4312826 -0.2357891
9  -0.5080005  1.7846997 -0.6470491
10 -0.5080005 -0.5504214 -1.0308917
11 -0.5080005 -0.4431965  1.5189202</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use this to compute the correlation matrix and plot it using ggplot.</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_normalized)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_Gnaphalium.spp.-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher value means there's positive correlation between the two variables</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Value closer to -1 means they are more negatively correlated. </span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Branches per stem shows the darkest red, meaning it has the highest values closer to 1. So now I use regression analysis to check for its R-squared value.</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Gnaphalium spp. : test for branch per stem measurements</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Biomass <span class="sc">~</span> Branches_per_stem,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span> spec[[<span class="st">"Gnaphalium spp."</span>]])</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Biomass ~ Branches_per_stem, data = spec[["Gnaphalium spp."]])

Residuals:
       7        8        9       10       11 
-0.09989 -0.11469 -0.04950  0.09743  0.16664 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)       -0.10263    0.15925  -0.644   0.5651  
Branches_per_stem  0.07173    0.01516   4.733   0.0179 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1447 on 3 degrees of freedom
Multiple R-squared:  0.8819,    Adjusted R-squared:  0.8425 
F-statistic:  22.4 on 1 and 3 DF,  p-value: 0.01788</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.8425 and p-value is 0.01788, which means that the model does explain the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Gnaphalium spp. since it has the highest R-squared value.</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Gnaphalium spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Branches_per_stem, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Branches per stem (n)"</span>) <span class="sc">+</span> </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Branches per stem vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Gnaphalium spp."</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_Gnaphalium.spp.-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>gnaphalium <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Gnaphalium spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Branches_per_stem, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Branches per stem (n)"</span>) <span class="sc">+</span> </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Branches per stem vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Gnaphalium spp."</span>))))</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"4_Gnaphalium_branchperstem.png"</span>, results_path), gnaphalium)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="rhus-integrifolia" class="level1">
<h1>5. Rhus integrifolia</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance matrix</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We create new data with only the numeric columns.</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>numerical_data <span class="ot">&lt;-</span> spec[[<span class="st">"Rhus integrifolia"</span>]][, <span class="dv">7</span><span class="sc">:</span><span class="dv">26</span>]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is to normalize the new data we just created.</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>data_normalized <span class="ot">&lt;-</span> <span class="fu">scale</span>(numerical_data)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_normalized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Height Width_farthest Width_perpendicular Branch_length Branch_diameter
93 -0.4934649     -0.8680912          -0.4723837    -0.3553099      -0.5869301
94  0.1470905      0.3896546           0.4478443     0.2400485       0.6900008
95 -0.4460164     -0.4488426          -0.7484522    -0.6577520      -0.7243577
96 -0.8730533     -0.6461360          -0.7791264    -0.8554110      -0.7987976
97  1.6654441      1.5734153           1.5521180     1.6284244       1.4200846
   Stem_diameter Stem_height Stem_density Branches_per_stem Total_leaves
93    -1.0059597   1.3717938          NaN        -0.8228943   -0.6678437
94     0.5474997   0.5765510          NaN         0.8690380    0.8148405
95    -0.8070411  -0.5169078          NaN        -0.6306293   -0.6932756
96    -0.1534515  -1.2127452          NaN        -0.7075353   -0.7899171
97     1.4189526  -0.2186918          NaN         1.2920210    1.3361960
    Leaf_lmax  Leaf_lmin  Leaf_lavg  Leaf_wmax  Leaf_wmin  Leaf_wavg  Leaf_tmax
93 -0.5020790 -0.6439906 -0.9602637 -0.7844645 -0.5934424 -0.3600709 -1.0550088
94  1.5518806 -0.3963019  1.1476323  1.5689291 -0.5934424  0.8495422  1.5825131
95  0.4107919  1.5852077  1.0071059 -0.3922323  1.3846990  0.7651506 -0.3956283
96 -0.5020790 -0.8916793 -0.7260531 -0.7844645 -0.9231327 -1.5696839 -0.3956283
97 -0.9585145  0.3467642 -0.4684213  0.3922323  0.7253185  0.3150620  0.2637522
    Leaf_tmin  Leaf_tavg    Biomass
93  0.4472136 -0.8627950 -0.6517155
94  0.4472136  1.3879745  0.3664820
95  0.4472136 -0.5814488 -0.6404265
96 -1.7888544 -0.6752308 -0.6778690
97  0.4472136  0.7315001  1.6035290</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use this to compute the correlation matrix and plot it using ggplot.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_normalized)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_R.integrifolia-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher value means there's positive correlation between the two variables</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Value closer to -1 means they are more negatively correlated. </span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple variables show the darkest red, meaning they have higher values closer to 1. So now I use regression analysis to check for its R-squared value.</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Rhus integrifolia : test for branch length measurements</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Biomass <span class="sc">~</span> Branch_length,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span> spec[[<span class="st">"Rhus integrifolia"</span>]])</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Biomass ~ Branch_length, data = spec[["Rhus integrifolia"]])

Residuals:
      93       94       95       96       97 
-150.573   64.978    3.047   81.131    1.417 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   -440.792     99.849  -4.415  0.02157 * 
Branch_length   23.307      2.516   9.263  0.00266 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 105.7 on 3 degrees of freedom
Multiple R-squared:  0.9662,    Adjusted R-squared:  0.955 
F-statistic: 85.81 on 1 and 3 DF,  p-value: 0.002662</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.955 and p-value is 0.002662, which means that the model does explain the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Rhus integrifolia since it has the highest R-squared value.</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Rhus integrifolia"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Branch_length, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Branch Length(n)"</span>) <span class="sc">+</span> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Branch Length vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Rhus integrifolia"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_R.integrifolia-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>R.integrifolia <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Rhus integrifolia"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Branch_length, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Branch Length (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Branch Length vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Rhus integrifolia"</span>))))</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"5_R.integrifolia_branchlength.png"</span>, results_path), R.integrifolia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="solidago-spp." class="level1">
<h1>6. Solidago spp.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance matrix</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We create new data with only the numeric columns.</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>numerical_data <span class="ot">&lt;-</span> spec[[<span class="st">"Solidago spp."</span>]][, <span class="dv">8</span><span class="sc">:</span><span class="dv">23</span>]</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is to normalize the new data we just created.</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>data_normalized <span class="ot">&lt;-</span> <span class="fu">scale</span>(numerical_data)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_normalized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Height Width_farthest Width_perpendicular Stem_diameter Stem_height
81  1.5197707     1.30005091           1.6533639    -0.5976143  -1.1076319
82  0.5497043     0.85852419           0.5904871     1.7928429   1.5901647
83 -0.4203621    -0.02452926          -0.1180974    -1.1952286  -0.3838328
84  0.3556910     0.12264631          -0.2952436     0.0000000   0.6031659
85 -1.1964153    -1.20193386          -0.6495358     0.0000000  -0.8444323
86 -0.8083887    -1.05475829          -1.1809742     0.0000000   0.1425665
   Total_leaves  Leaf_lmax  Leaf_lmin  Leaf_lavg   Leaf_wmax  Leaf_wmin
81    0.6172134  1.7520115  1.3095568  1.7644601  1.65788773  0.7266724
82    0.6172134  0.5201284  0.4365189  0.5759637  0.61861482  0.1816681
83    1.0801234 -0.3011270 -0.9603417 -0.3138850 -0.56912564 -1.1808427
84    0.1543033 -0.3011270 -1.3968606 -0.6430071 -1.01452831 -1.1808427
85   -1.2344268 -1.0402568  0.4365189 -0.8989909 -0.71759320  0.1816681
86   -1.2344268 -0.6296291  0.1746076 -0.4845409  0.02474459  1.2716767
    Leaf_wavg  Leaf_tmax  Leaf_tmin  Leaf_tavg    Biomass
81  1.5627096  1.6137431  1.5498260  1.2441391  1.8168483
82  0.4335259 -0.3227486  0.2214037  0.3337934  0.4542121
83 -0.5545099 -1.2909944 -1.1070186 -1.1227597 -0.2271060
84 -1.2199217 -0.3227486 -1.1070186 -1.1227597 -0.6606721
85 -0.6351659 -0.3227486  0.2214037 -0.2124140 -0.8464861
86  0.4133619  0.6454972  0.2214037  0.8800008 -0.5367961</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use this to compute the correlation matrix and plot it using ggplot.</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_normalized)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_Solidago.spp.-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher value means there's positive correlation between the two variables</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Value closer to -1 means they are more negatively correlated. </span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple variables show the darkest red, meaning they have higher values closer to 1. So now I use regression analysis to check for its R-squared value.</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Solidago spp. : test for average leaf length measurements</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Biomass <span class="sc">~</span> Leaf_lavg,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span> spec[[<span class="st">"Solidago spp."</span>]])</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Biomass ~ Leaf_lavg, data = spec[["Solidago spp."]])

Residuals:
       81        82        83        84        85        86 
 0.009338 -0.019370  0.013854 -0.003173  0.008029 -0.008678 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.283905   0.019046  -14.91 0.000118 ***
Leaf_lavg    0.098098   0.003865   25.38 1.43e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01418 on 4 degrees of freedom
Multiple R-squared:  0.9938,    Adjusted R-squared:  0.9923 
F-statistic: 644.3 on 1 and 4 DF,  p-value: 1.431e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.9923 and p-value is 1.431e-05, which means that the model does explain the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Solidago spp. since it has the highest R-squared value.</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Solidago spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Leaf_lavg, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Average leaf length (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Average leaf length vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Solidago spp."</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_Solidago.spp.-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>solidago <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Solidago spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Leaf_lavg, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Average leaf length (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Average leaf length vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Solidago spp."</span>))))</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"6_Solidago_avgleaflength.png"</span>, results_path), solidago)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="baccharis-pilularis" class="level1">
<h1>7. Baccharis pilularis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For non-normally distributed data (where the response variable, biomass, is not normally distributed), we use a generalized linear model (glm). </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also use a log transformation to transform the data to a more normally distributed dataset.</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For our analysis, we will use a log transformation before. </span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>spec[[<span class="st">"Baccharis pilularis"</span>]]<span class="sc">$</span>log <span class="ot">&lt;-</span> <span class="fu">log</span>(spec[[<span class="st">"Baccharis pilularis"</span>]]<span class="sc">$</span>Biomass)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Baccharis pilularis"</span>]]<span class="sc">$</span>log))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Baccharis pilularis"]]$log
W = 0.96225, p-value = 0.8378</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(spec[[<span class="st">"Baccharis pilularis"</span>]]<span class="sc">$</span>log)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(y); <span class="fu">qqline</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_B.pilularis-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Baccharis pilularis: test for width measurements </span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log <span class="sc">~</span> Width_farthest,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> spec[[<span class="st">"Baccharis pilularis"</span>]])</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log ~ Width_farthest, data = spec[["Baccharis pilularis"]])

Residuals:
      70       71       72       73       74       75       76 
-0.08158 -0.11216  0.56119 -0.08034 -0.12207  0.34913 -0.51417 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    1.825384   0.368178   4.958 0.004256 ** 
Width_farthest 0.046113   0.006539   7.052 0.000886 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3852 on 5 degrees of freedom
Multiple R-squared:  0.9086,    Adjusted R-squared:  0.8904 
F-statistic: 49.73 on 1 and 5 DF,  p-value: 0.0008862</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.8904 and p-value is 0.0008862, which means that the model does explain the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Baccharis pilularis since it has the highest R-squared value.</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Baccharis pilularis"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Width_farthest, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Width (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Width vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Baccharis pilularis"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_B.pilularis-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>b.pilularis <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Baccharis pilularis"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Width_farthest, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Width (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Width vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Baccharis pilularis"</span>))))</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"7_B.pilularis_width.png"</span>, results_path), b.pilularis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="euphorbia-spp." class="level1">
<h1>8. Euphorbia spp.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Euphorbia spp.: test for width measurements </span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Biomass <span class="sc">~</span> Width_farthest,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> spec[[<span class="st">"Euphorbia spp."</span>]])</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Biomass ~ Width_farthest, data = spec[["Euphorbia spp."]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.33747 -0.06636 -0.04936  0.14139  0.21409 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -0.413415   0.109768  -3.766 0.007017 ** 
Width_farthest  0.076222   0.009804   7.775 0.000109 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1794 on 7 degrees of freedom
Multiple R-squared:  0.8962,    Adjusted R-squared:  0.8814 
F-statistic: 60.44 on 1 and 7 DF,  p-value: 0.0001094</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.8814 and p-value is 0.0001094, which means that the model does explain the variation of the data (fits the regression model). Even though the dataset was not normally distributed, the R-squared value is greater without a log transformation.  </span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Euphorbia spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Width_farthest, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Width (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Width vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Euphorbia spp."</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_Euphorbia.spp.-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>euphorbia <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Euphorbia spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Width_farthest, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Width (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Width vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Euphorbia spp."</span>))))</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"8_Euphorbia_width.png"</span>, results_path), euphorbia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="lactucca-spp." class="level1">
<h1>9. Lactucca spp.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lactucca spp.: test for width measurements </span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Biomass <span class="sc">~</span> Total_leaves,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> spec[[<span class="st">"Lactucca spp."</span>]])</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Biomass ~ Total_leaves, data = spec[["Lactucca spp."]])

Residuals:
      12       13       14       15       16 
-0.05320 -0.05881 -0.01521  0.11198  0.01524 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.336378   0.050391  -6.675 0.006855 ** 
Total_leaves  0.063598   0.002528  25.153 0.000138 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0802 on 3 degrees of freedom
Multiple R-squared:  0.9953,    Adjusted R-squared:  0.9937 
F-statistic: 632.7 on 1 and 3 DF,  p-value: 0.0001378</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.9937 and p-value is 0.0001378, which means that the model does explain the variation of the data (fits the regression model). Even though the dataset was not normally distributed, the R-squared value is greater without a log transformation.  </span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Lactucca spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Total_leaves, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Total Leaves (n)"</span>) <span class="sc">+</span> </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Total Leaves vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Lactucca spp."</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_Lactucca.spp.-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>lactucca <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Lactucca spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Total_leaves, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Total Leaves (n)"</span>) <span class="sc">+</span> </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Total Leaves vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Lactucca spp."</span>))))</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"9_Lactucca_totalleaves.png"</span>, results_path), lactucca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="onetheria-biennis" class="level1">
<h1>10. Onetheria biennis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>spec[[<span class="st">"Onetheria biennis"</span>]]<span class="sc">$</span>log <span class="ot">&lt;-</span> <span class="fu">log</span>(spec[[<span class="st">"Onetheria biennis"</span>]]<span class="sc">$</span>Biomass)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Onetheria biennis"</span>]]<span class="sc">$</span>log))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Onetheria biennis"]]$log
W = 0.90442, p-value = 0.2787</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(spec[[<span class="st">"Onetheria biennis"</span>]]<span class="sc">$</span>log)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(y); <span class="fu">qqline</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_O.biennis-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Onetheria biennis: test for height measurements </span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log <span class="sc">~</span> Height,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> spec[[<span class="st">"Onetheria biennis"</span>]])</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log ~ Height, data = spec[["Onetheria biennis"]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.56859 -0.52104 -0.16588  0.05594  1.12670 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2.99552    0.54091  -5.538 0.000871 ***
Height       0.28904    0.04778   6.049 0.000516 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7072 on 7 degrees of freedom
Multiple R-squared:  0.8394,    Adjusted R-squared:  0.8165 
F-statistic: 36.59 on 1 and 7 DF,  p-value: 0.0005163</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.8165 and p-value is 0.0005163, which means that the model does explain the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Onetheria biennis since it has the highest R-squared value.</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Onetheria biennis"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Height, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Height (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Height vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Onetheria biennis"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_O.biennis-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>o.biennis <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Onetheria biennis"</span>), <span class="fu">aes</span>(<span class="at">x=</span>Height, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Height (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Height vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Onetheria biennis"</span>))))</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"10_O.biennis_height.png"</span>, results_path), o.biennis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
<section id="salix-spp." class="level1">
<h1>11. Salix spp.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>spec[[<span class="st">"Salix spp."</span>]]<span class="sc">$</span>log <span class="ot">&lt;-</span> <span class="fu">log</span>(spec[[<span class="st">"Salix spp."</span>]]<span class="sc">$</span>Biomass)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">shapiro.test</span>(spec[[<span class="st">"Salix spp."</span>]]<span class="sc">$</span>log))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  spec[["Salix spp."]]$log
W = 0.90844, p-value = 0.3051</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(spec[[<span class="st">"Salix spp."</span>]]<span class="sc">$</span>log)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(y); <span class="fu">qqline</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_Salix%20spp.-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Salix spp.: test for height measurements </span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log <span class="sc">~</span> Height,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> spec[[<span class="st">"Salix spp."</span>]])</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log ~ Height, data = spec[["Salix spp."]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62375 -0.29584 -0.04587  0.46023  0.48945 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.295158   0.293379  -4.415   0.0031 ** 
Height       0.026705   0.001835  14.551 1.73e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4453 on 7 degrees of freedom
Multiple R-squared:  0.968, Adjusted R-squared:  0.9634 
F-statistic: 211.7 on 1 and 7 DF,  p-value: 1.728e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared value is 0.9634 and p-value is 1.728e-06, which means that the model does explain the variation of the data (fits the regression model) and it is also significant. This morphological characteristic might be a good biomass indicator for Salix spp. since it has the highest R-squared value.</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot to plot it</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Salix spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Height, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Height (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Height vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Salix spp."</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="exploratory_analysis_files/figure-html/linear_regression_model_Salix%20spp.-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to .png file</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>salix <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">subset</span>(dat,Species<span class="sc">==</span><span class="st">"Salix spp."</span>), <span class="fu">aes</span>(<span class="at">x=</span>Height, <span class="at">y=</span>Biomass), <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">geom =</span> <span class="st">"smooth"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="st">"Height (cm)"</span>) <span class="sc">+</span> </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Biomass (g)"</span>) <span class="sc">+</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Height vs. Biomass for"</span>, <span class="fu">substitute</span>(<span class="fu">paste</span>(<span class="fu">italic</span>(<span class="st">"Salix spp."</span>))))</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">addpath</span>(<span class="st">"11_Salix_height.png"</span>, results_path), salix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>